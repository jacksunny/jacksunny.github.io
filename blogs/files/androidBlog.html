<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>

   <meta charset="utf-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
   
	
<link rel="stylesheet" href="resources/font-awesome/css/font-awesome.min.css?v=481458904">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="robots" content="noindex, follow" />
		<meta name="generator" content="RapidWeaver" />
		<!-- User defined head content such as meta tags and encoding options -->
	<title> <i class="fa fa-spinner fa-spin"></i> Drawable根据时间插值自定义动画 | Blog Page</title>
	
	<!-- Google's Font service -->		
	<link href='http://fonts.googleapis.com/css?family=Raleway:400|Ruluko|Open%20Sans%20Condensed:300|Bree%20Serif|?v=481458904' rel='stylesheet' type='text/css'>  
	<!-- Awesome Font - Icons -->  
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
	   		   
	<link rel="stylesheet" type="text/css" media="all" href="../rw_common/themes/lander/consolidated-2.css?v=481458904" />
		
	
	
	<!-- Style variations - these are set up in the theme.plist -->
	<style type="text/css" media="all">#drop:after {content:"TOOLBAR";}
</style><!-- User defined styles -->
			
	  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> 
	  
      <script type="text/javascript" src="../rw_common/themes/lander/javascript.js?v=481458904"></script>
	 <script type="text/javascript" src="../rw_common/themes/lander/js/box.js?v=481458904"></script>
	 <script type="text/javascript" src="../rw_common/themes/lander/js/multithemes.js?v=481458904"></script> 
	 
	<!-- User defined javascript -->
	<link rel="alternate" type="application/rss+xml" title="user" href="http://rdors.com/files/RSS Feed2.xml" />
<script type="text/javascript" async src="http://rdors.com/files/meta.js"></script>

	<link rel="stylesheet" href="../resources/highlight/styles/gruvbox-light.css?v=481458904">
<script src="../resources/highlight/highlight.pack.js?v=481458904"></script>
<script>hljs.initHighlightingOnLoad();</script>

	
</head>
	
<!-- This page was created with RapidWeaver from Realmac Software. http://www.realmacsoftware.com -->

<body>
<div id="container"><!-- Start container -->	 
<!--box trigger-->
<div id="drop" class="togglebox">
    <i class="fa fa-plus-square-o"></i>
  </div>
<div class="clearer"></div>
 <!--drop nav --> 
  <div id="accordion"><!-- BOX-->	 
     <div id="navcontainer_box">
     <div id="navcontainer_opacity"></div>
       <div id="navcontainer"><ul><li><a href="../blog/" rel="">Unity3d</a></li></ul></div>
      </div>
    </div><!-- BOX END--> 
   <div class="clearer"></div>    
  <div id="headerbox">  
   <div id="rw-banner-image"> </div>    
    <div id="banner_grid"></div>        
      <div id="pageHeader"><!-- Start page header -->
     <div id="logo"><a href="http://rdors.com/"><img src="../rw_common/images/logo.png" width="100" height="100" alt="<i class="fa fa-android"></i> Android"/></a></div>
	  <div id="fade_titles">	
	   <h1><i class="fa fa-android"></i> Android</h1>
	   <h2> </h2></div>
    </div><!-- End page header -->        
  <div id="breadcrumbcontainer_box">  
    <div id="opacity_background"></div>
     <div id="breadcrumbcontainer">   
        <ul><li><a href="../">Blog</a>&nbsp;&nbsp;</li></ul>
      </div><!-- End breadcrumb -->
    </div><!-- End breadcrumbcontainer_box -->  
  </div><!-- End headerbox-->     
 <div id="global_width">	 	
	 <div id="contentContainer"><!-- Start main content wrapper -->
		 <div id="content"><!-- Start content -->
		   	
	<div class="blog-archive-entries-wrapper">
		<div id="unique-entry-id-16" class="blog-entry"><h1 class="blog-entry-title"> <i class="fa fa-spinner fa-spin"></i> Drawable根据时间插值自定义动画</h1><div class="blog-entry-date">07/12/15 - 09:31 Filed in: <span class="blog-entry-category"><a href="category-android.html">Android</a></span></div><div class="blog-entry-summary"><span style="font:14px PingFangSC-Regular; color:#252525;">本文会带来什么？</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;"><br /></span><ul class="disc"><li><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;">xml</span><span style="font:14px PingFangSC-Regular; color:#252525;">如何自定义圆角</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;"> shapeDrawable</span><span style="font:14px PingFangSC-Regular; color:#252525;">？环形？三角形？</span></li><li><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;">drawable</span><span style="font:14px PingFangSC-Regular; color:#252525;">有多少种？用法是什么？</span></li><li><span style="font:14px PingFangSC-Regular; color:#252525;">绘制圆弧用法，原理？</span></li></ul><span style="font:14px PingFangSC-Semibold; font-weight:bold; color:#252525;font-weight:bold; ">上面的统统没有！只说将一个关于</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; font-weight:bold; color:#252525;font-weight:bold; ">Drawable</span><span style="font:14px PingFangSC-Semibold; font-weight:bold; color:#252525;font-weight:bold; ">不常用到的用法<br></span></div><div class="blog-entry-body"><span style="font:16px PingFangSC-Semibold; font-weight:bold; color:#252525;font-weight:bold; ">我们要实现的效果如下图</span><span style="font:16px Arial, Verdana, Helvetica, sans-serif; font-weight:bold; color:#252525;font-weight:bold; "><br /></span><img class="imageStyle" alt="20151217105800205" src="20151217105800205.gif" width="252" height="448" /><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;"><br /></span><span style="font:14px PingFangSC-Regular; color:#636363;">第一个想法你想用什么来实现？在</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;"><em>view </em></span><span style="font:14px PingFangSC-Regular; color:#636363;">的</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;"><em> onDraw</em></span><span style="font:14px PingFangSC-Regular; color:#636363;">中实现？这也许是很多人的第一个想法，我也是</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;"><br /></span><span style="font:14px PingFangSC-Regular; color:#636363;">但想起之前在</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;"><em>github</em></span><span style="font:14px PingFangSC-Regular; color:#636363;">上翻看某大神源码时看到用自定义</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;"><em>Drawable + </em></span><span style="font:14px PingFangSC-Regular; color:#636363;">动画器插值实现了一个太阳冉冉升起的动画，就想采用类似的做法来做</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;"><br /></span><span style="font:16px PingFangSC-Semibold; font-weight:bold; color:#252525;font-weight:bold; ">具体思路如下：</span><span style="font:16px Arial, Verdana, Helvetica, sans-serif; font-weight:bold; color:#252525;font-weight:bold; "><br /></span><ol class="arabic-numbers"><li><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;">gif</span><span style="font:14px PingFangSC-Regular; color:#252525;">图片中的弧形动画以及阻尼动画，说白了也就是</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;">canvas</span><span style="font:14px PingFangSC-Regular; color:#252525;">绘制圆弧等的组合，即根据时间变化计算绘制相应图形即可</span></li><li><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;">Drawable</span><span style="font:14px PingFangSC-Regular; color:#252525;">中有</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;">draw(Canvas canvas)</span><span style="font:14px PingFangSC-Regular; color:#252525;">方法，在此方法中可通过</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;">canvas</span><span style="font:14px PingFangSC-Regular; color:#252525;">进行绘制</span></li><li><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;">View</span><span style="font:14px PingFangSC-Regular; color:#252525;">实现</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;">TranslationAnimation</span><span style="font:14px PingFangSC-Regular; color:#252525;">，可实现整体的上移或者下移，同时创建时间插值</span></li><li><span style="font:14px PingFangSC-Regular; color:#252525;">把</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;">View</span><span style="font:14px PingFangSC-Regular; color:#252525;">动画创建的时间插值动态传递给</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;">Drawable</span><span style="font:14px PingFangSC-Regular; color:#252525;">，</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;">Drawable</span><span style="font:14px PingFangSC-Regular; color:#252525;">根据时间插值，动态计算并绘制图形</span></li></ol><span style="font:16px PingFangSC-Semibold; font-weight:bold; color:#252525;font-weight:bold; ">好处如下：</span><span style="font:16px Arial, Verdana, Helvetica, sans-serif; font-weight:bold; color:#252525;font-weight:bold; "><br /></span><ol class="arabic-numbers"><li><span style="font:14px PingFangSC-Regular; color:#252525;">使用</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;">Drawable</span><span style="font:14px PingFangSC-Regular; color:#252525;">而不是在</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;">View</span><span style="font:14px PingFangSC-Regular; color:#252525;">中来绘制，不会影响到之前</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;">View</span><span style="font:14px PingFangSC-Regular; color:#252525;">中</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;">onDraw</span><span style="font:14px PingFangSC-Regular; color:#252525;">的代码和逻辑</span></li><li><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;">Drawable</span><span style="font:14px PingFangSC-Regular; color:#252525;">一般当做背景，与</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;">view</span><span style="font:14px PingFangSC-Regular; color:#252525;">耦合很小</span></li><li><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;">Animation</span><span style="font:14px PingFangSC-Regular; color:#252525;">产生插值，可设置不同加速器</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;"> </span><span style="font:14px PingFangSC-Regular; color:#252525;">产生不同效果</span></li></ol><span style="font:14px PingFangSC-Semibold; font-weight:bold; color:#252525;font-weight:bold; ">可见，我们所有需要的前置条件都已经满足了，现在开始</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; font-weight:bold; color:#252525;font-weight:bold; "> </span><span style="font:14px PingFangSC-Semibold; font-weight:bold; color:#252525;font-weight:bold; ">实现</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#252525;"><br /></span><span style="font:28px PingFangSC-Semibold; font-weight:bold; color:#252525;font-weight:bold; ">以下为部分代码</span><span style="font:28px Arial, Verdana, Helvetica, sans-serif; font-weight:bold; color:#252525;font-weight:bold; "><br /></span><span style="font:16px Arial, Verdana, Helvetica, sans-serif; font-weight:bold; color:#252525;font-weight:bold; ">1.</span><span style="font:16px PingFangSC-Semibold; font-weight:bold; color:#252525;font-weight:bold; ">创建</span><span style="font:16px Arial, Verdana, Helvetica, sans-serif; font-weight:bold; color:#252525;font-weight:bold; ">TranslationAnimation</span><span style="font:16px PingFangSC-Semibold; font-weight:bold; color:#252525;font-weight:bold; ">产生时间插值<br /><br /><br /></span><span style="font:14px PingFangSC-Regular; color:#636363;">第一个想法你想用什么来实现？在</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;"><em>view </em></span><span style="font:14px PingFangSC-Regular; color:#636363;">的</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;"><em> onDraw</em></span><span style="font:14px PingFangSC-Regular; color:#636363;">中实现？这也许是很多人的第一个想法，我也是我也是我也是</span><span style="color:#353535;"><br /></span><span style="color:#353535;"><br /><code><pre></span><span style="font:16px Arial, Verdana, Helvetica, sans-serif; font-weight:bold; color:#252525;font-weight:bold; "><br /></span><span style="color:#353535;">final AnimationSet as = new AnimationSet(true);<br />as.setDuration(600);<br />TranslateAnimation translateAnimation = new TranslateAnimation(<br />        ScaleAnimation.RELATIVE_TO_SELF,0,<br />        ScaleAnimation.RELATIVE_TO_SELF,0,<br />        ScaleAnimation.RELATIVE_TO_SELF,1.0f,<br />        ScaleAnimation.RELATIVE_TO_SELF,0){<br />    @Override<br />    protected void applyTransformation(float interpolatedTime, Transformation t) {<br />        super.applyTransformation(interpolatedTime, t);<br />        myDrawable.setPercent(interpolatedTime, true);<br />    }<br />};<br />as.addAnimation(translateAnimation);<br />return as;<br /></pre></code><br /><br /><br /></span><span style="font:14px PingFangSC-Regular; color:#636363;">第一个想法你想用什么来实现？在</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;"><em>view </em></span><span style="font:14px PingFangSC-Regular; color:#636363;">的</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;"><em> onDraw</em></span><span style="font:14px PingFangSC-Regular; color:#636363;">中实现？这也许是很多人的第一个想法，我也是我也是我也是</span><span style="color:#353535;"><br /></span><span style="color:#353535;"><br /></span><span style="font:16px Arial, Verdana, Helvetica, sans-serif; font-weight:bold; color:#252525;font-weight:bold; ">2.</span><span style="font:16px PingFangSC-Semibold; font-weight:bold; color:#252525;font-weight:bold; ">自定义</span><span style="font:16px Arial, Verdana, Helvetica, sans-serif; font-weight:bold; color:#252525;font-weight:bold; ">Drawable</span><span style="font:16px PingFangSC-Semibold; font-weight:bold; color:#252525;font-weight:bold; ">及讲解<br /><br /></span><span style="color:#353535;"><code><pre class="css"></span><br />public class MyAnimationDrawable3 extends Drawable implements Drawable.Callback {<br />	private Paint mPaint;<br />	private int mWidth;<br />	private int mHeight;<br />	public MyAnimationDrawable3(int width,int height) {<br />    		mPaint = new Paint();<br />    		mWidth = width;<br />    		mHeight = height;<br />	}<br /><br />	@Override<br />	public void draw(Canvas canvas) {<br />    		// <span style="font:12px PingFangSC-Regular; ">主要绘制代码</span><br />		//  canvas.drawRoundRect(rectF, 30, 30, mPaint);<br />	}<br /><br />	@Override<br />	public int getIntrinsicWidth() {<br />    		return mWidth;<br />	}<br /><br />	@Override<br />	public int getIntrinsicHeight() {<br />    		return mHeight;<br />	}<br /><br />	@Override<br />	public void setAlpha(int alpha) {<br />    		mPaint.setAlpha(alpha);<br />	}<br /><br />	@Override<br />	public void setColorFilter(ColorFilter cf) {<br />   	 	mPaint.setColorFilter(cf);<br />	}<br /><br />	@Override<br />	public int getOpacity() {<br />    		return PixelFormat.TRANSLUCENT;<br />	}<br /><br />	@Override<br />	public void invalidateDrawable(Drawable who) {<br />    		final Callback callback = getCallback();<br />    		if (callback != null) {<br />        			callback.invalidateDrawable(this);<br />    		}<br />	}<br /><br />	@Override<br />	public void scheduleDrawable(Drawable who, Runnable what, long when) {<br />    		final Callback callback = getCallback();<br />    		if (callback != null) {<br />        		    callback.scheduleDrawable(this, what, when);<br />    		}<br />	}<br /><br />	@Override<br />	public void unscheduleDrawable(Drawable who, Runnable what) {<br />    		final Callback callback = getCallback();<br />    		if (callback != null) {<br />        		    callback.unscheduleDrawable(this, what);<br />    		}<br />	}<br />}<br /><span style="color:#353535;"></pre></code></span><br /><br /><br /><span style="font:14px PingFangSC-Regular; color:#636363;">其中</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;">draw</span><span style="font:14px PingFangSC-Regular; color:#636363;">中负责具体绘制，</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;">getIntrinsicWidth,getIntrinsicHeight</span><span style="font:14px PingFangSC-Regular; color:#636363;">为指定宽高，<br /></span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;">setAlpha,setColorFilter</span><span style="font:14px PingFangSC-Regular; color:#636363;">等都很简单，最后，该类实现</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;">Drawable.CallBack</span><span style="font:14px PingFangSC-Regular; color:#636363;">，<br />实现最后三个方法，作用是</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;">&ldquo;</span><span style="font:14px PingFangSC-Regular; color:#636363;">把你实现的该接口注册到动画</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;">Drawable</span><span style="font:14px PingFangSC-Regular; color:#636363;">上可以实现动态</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;">Drawable</span><span style="font:14px PingFangSC-Regular; color:#636363;">的调度和执行</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;">&rdquo;<br /></span><span style="font:14px PingFangSC-Regular; color:#636363;">第一个想法你想用什么来实现？在</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;"><em>view </em></span><span style="font:14px PingFangSC-Regular; color:#636363;">的</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;"><em> onDraw</em></span><span style="font:14px PingFangSC-Regular; color:#636363;">中实现？这也许是很多人的第一个想法，我也是我也是我也是</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;"><br /></span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;"><br /></span><span style="font:16px Arial, Verdana, Helvetica, sans-serif; font-weight:bold; color:#252525;font-weight:bold; ">3.</span><span style="font:16px PingFangSC-Semibold; font-weight:bold; color:#252525;font-weight:bold; ">传递时间插值进入</span><span style="font:16px Arial, Verdana, Helvetica, sans-serif; font-weight:bold; color:#252525;font-weight:bold; ">Drawable<br /><br /></span><span style="color:#353535;"><code><pre></span><br /> /**<br /> * @param percent <span style="font:12px PingFangSC-Regular; ">时间插值</span><br /> */<br />public void setPrecent(float percent){<br />    if (percent > 0.5f) {<br />         /**<br />           * <span style="font:12px PingFangSC-Regular; ">啊</span><br />           **/<br />    }else{<br />        // <span style="font:12px PingFangSC-Regular; ">逻辑代码，计算弧度等</span><br />    }<br />    // <span style="font:12px PingFangSC-Regular; ">刷新</span> draw <span style="font:12px PingFangSC-Regular; ">图形</span><br />    invalidateSelf();<br />}<br /><span style="color:#353535;"></pre></code></span><br /><br /><br /><span style="font:14px PingFangSC-Regular; color:#636363;">传递进去时间插值后，即可根据时间插值计算相关弧度，在</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;">draw</span><span style="font:14px PingFangSC-Regular; color:#636363;">中进行绘制即可完成动态图中的效果（绘制逻辑</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;"> </span><span style="font:14px PingFangSC-Regular; color:#636363;">就不说了，大概为插值</span><span style="font:14px Arial, Verdana, Helvetica, sans-serif; color:#636363;">0-1</span><span style="font:14px PingFangSC-Regular; color:#636363;">绘制向上半圆弧，到顶点根据阻尼振动函数绘制半径变化的圆弧）</span><span style="color:#353535;"><br /></span></div></div>
	</div>
	

		 </div><!-- End content -->
	 </div><!-- End main content wrapper -->
  <div id="sidebarBackground"></div>
<div id="sidebarContainer"><!-- Start Sidebar wrapper -->
  <div class="sideHeader">My Blog</div><!-- Sidebar header -->
	 <div id="sidebar"><!-- Start sidebar content -->
	 <div id="blog-categories"><a href="category-android.html" class="blog-category-link-enabled">Android (1)</a><br /></div><div id="blog-archives"><a class="blog-archive-link-enabled" href="archive-december-2015.html">December 2015</a><br /></div><div id="blog-rss-feeds"><a class="blog-rss-link" href="RSS Feed2.xml" rel="alternate" type="application/rss+xml" title="user">RSS Feed</a><br /></div> <!-- sidebar content such as the blog archive links -->
	 <div class="clearer"></div>
		<p style="text-align:center;"> <a href="#"><i class="fa fa-android  fa-5x fa-fw"></i></a> <br /><br /></p><p style="text-align:left;"><br /> <hr><br /><h4>提供一些关于乱七八糟的文章，有原创，有汇总，总一款适合你，有想了解的技术点可以联系rd哥哥，rd哥哥带你飞<i class="fa fa-send "></i>！</h4><br /><br /></p><!-- sidebar content you enter in the page inspector -->		
     </div><!-- End sidebar content -->
   </div><!-- End sidebar wrapper -->
 </div><!-- global_width -->
<div class="clearer"></div>	
  <div id="footer"><!-- Start Footer -->
   <div class="footer_breadcrumbcontainer"> <ul><li><a href="../">Blog</a>&nbsp;&nbsp;</li></ul></div>
	  <p>Site made with jackSunny&copy;</p>
  </div><!-- End Footer -->
</div><!-- End container -->

 <div id="up"><a href="#up"><span><i class="fa fa-angle-up"></i></span></a></div>

<!-- trigger options in multithemes.js -->
<div id="banner_parallax_on_off" class="settings"></div>
<div id="menuOpened" class="settings"></div>
<div id="banner_fade_in" class="settings"></div>

<!-- theme by http://www.multithemes.com -->
</body>
</html>
